<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ticket Details</title>
  <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css"
      integrity="sha512-DxV+EoADOkOygM4IR9yXP8Sb2qwgidEmeqAEmDKIOfPRQZOWbXCzLC6vjbZyy0vPisbH2SyW27+ddLVCN+OMzQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
  <link rel="stylesheet" href="style9.css">
</head>
<body>
  <div class="phone">
    <div class="top-bar">
      <a href="index8.html"><i class="fa-solid fa-arrow-left"></i></a>
      <span id="ticket-details"> Ticket details</span>
      <span id="supportBtn">Support</span>
    </div>

    <div class="card">
      <div class="title">Transport Dept. of Delhi</div>

      <div class="row">
        <span id="ticketCode" class="bold">DL1PD2306</span>
        <span id="fare" class="bold">₹ 22.79</span>
      </div>

      <div class="row">
        <span>
          <span class="label">Bus route</span><br>
          <span id="busRoute" class="bold">567DOWN</span>
        </span>
        <span>
          <span class="label">Fare</span><br>
          <span id="fare2">₹ 25.0</span>
        </span>
      </div>

      <div class="row">
        <span>
          <span class="label">Booking time</span><br>
          <span id="bookingTime" class="bold"></span>
        </span>
        <span>
          <span class="label">Bus tickets</span><br>
          1
        </span>
      </div>

      <div class="divider"></div>

      <div class="row">
        <span class="label">Starting bus stop</span>
      </div>
      <div class="row bold" id="startStop">
        Qamruddin Nagar Terminal
      </div>

      <div class="row" style="margin-top:10px;">
        <span class="label">Ending bus stop</span>
      </div>
      <div class="row bold" id="endStop">
        Sarai Kale Khan ISBT Terminal
      </div>

      <div class="row" style="margin-top:15px; font-size:13px;" id="ticketId">
        <p>T26062023eaa8836087</p>
      </div>

      <button class="qr-btn" onclick="showQR()">
        <img id="green_qr" src="https://png.pngtree.com/png-vector/20231014/ourmid/pngtree-green-qr-code-scanning-png-image_10286449.png">
        <p>Show QR Code</p></button>
        <div class="logo_container">
    <img id="dtc_logo" src="https://upload.wikimedia.org/wikipedia/en/f/fb/Delhi_Transport_Corporation_logo.png">
    <p id="ondc">ONDC</p>
    <p id="network">NETWORK</p>
  </div>
    </div>

    <div class="bottom-note">
      Terms of Use &nbsp;•&nbsp; Click to read the terms and conditions for this ticket.
    </div>
    
  </div>

  <!-- QR Popup -->
  <div id="qrPopup" class="qr-popup">
    <div class="qr-content">
      <div id="qrcode"></div>
      <button onclick="closeQR()" class="close-btn">Close</button>
    </div>
  </div>

  <!-- Edit Popup -->
  <div id="editPopup" class="qr-popup">
    <div class="qr-content">
      <h3>Edit Ticket Details</h3>
      <input type="text" id="editStart" placeholder="Starting bus stop" style="width:100%;margin-bottom:10px;">
      <input type="text" id="editEnd" placeholder="Ending bus stop" style="width:100%;margin-bottom:10px;">
      <input type="text" id="editTicketCode" placeholder="Ticket code" style="width:100%;margin-bottom:10px;">
      <input type="text" id="editBusRoute" placeholder="Bus route" style="width:100%;margin-bottom:10px;">
      <input type="text" id="editFare" placeholder="Fare" style="width:100%;margin-bottom:10px;">
      <input type="text" id="editFare2" placeholder="Secondary Fare" style="width:100%;margin-bottom:10px;">
      <input type="text" id="editTicketId" placeholder="Ticket ID" style="width:100%;margin-bottom:10px;">
      <button onclick="saveEdit()" class="close-btn" style="background:#00b15c;">Save</button>
      <button onclick="closeEdit()" class="close-btn" style="background:#888;margin-top:8px;">Cancel</button>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>

  <script>
    // Show formatted current date & time
    function formatDateTime() {
      const now = new Date();
      const options = { weekday: 'short', day: '2-digit', month: 'short', year: '2-digit' };
      const datePart = now.toLocaleDateString('en-US', options).replace(',', '');
      let hours = now.getHours();
      const minutes = now.getMinutes().toString().padStart(2, '0');
      const ampm = hours >= 12 ? 'PM' : 'AM';
      hours = hours % 12 || 12;
      return `${datePart} · ${hours}:${minutes} ${ampm}`;
    }
    document.getElementById('bookingTime').textContent = formatDateTime();

    // QR Logic
    function showQR() {
      const ticketId = document.getElementById('ticketId').textContent.trim();
      document.getElementById('qrPopup').style.display = 'flex';
      document.getElementById('qrcode').innerHTML = ""; 
      new QRCode(document.getElementById('qrcode'), {
        text: ticketId,
        width: 180,
        height: 180
      });
    }
    function closeQR() {
      document.getElementById('qrPopup').style.display = 'none';
    }

    // Edit Logic
    document.getElementById('supportBtn').addEventListener('click', openEdit);

    function openEdit() {
      document.getElementById('editStart').value = document.getElementById('startStop').textContent.trim();
      document.getElementById('editEnd').value = document.getElementById('endStop').textContent.trim();
      document.getElementById('editTicketCode').value = document.getElementById('ticketCode').textContent.trim();
      document.getElementById('editBusRoute').value = document.getElementById('busRoute').textContent.trim();
      document.getElementById('editFare').value = document.getElementById('fare').textContent.trim();
      document.getElementById('editFare2').value = document.getElementById('fare2').textContent.trim();
      document.getElementById('editTicketId').value = document.getElementById('ticketId').textContent.trim();
      document.getElementById('editPopup').style.display = 'flex';
    }

    function closeEdit() {
      document.getElementById('editPopup').style.display = 'none';
    }

    function saveEdit() {
      document.getElementById('startStop').textContent = document.getElementById('editStart').value;
      document.getElementById('endStop').textContent = document.getElementById('editEnd').value;
      document.getElementById('ticketCode').textContent = document.getElementById('editTicketCode').value;
      document.getElementById('busRoute').textContent = document.getElementById('editBusRoute').value;
      document.getElementById('fare').textContent = document.getElementById('editFare').value;
      document.getElementById('fare2').textContent = document.getElementById('editFare2').value;
      document.getElementById('ticketId').textContent = document.getElementById('editTicketId').value;
      closeEdit();
    }
  </script>
</body>
</html>
